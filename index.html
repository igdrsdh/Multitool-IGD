<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multitool Medis Digital</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:ital,opsz,wght@0,17..18,400..700;1,17..18,400..700&family=Jost:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Jost', 'Google Sans', sans-serif; 
        }
        h1, h2, .font-black {
            font-family: 'Google Sans', 'Jost', sans-serif;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        
        .btn-reset {
            transition: all 0.2s ease;
        }
        .btn-reset:active {
            transform: scale(0.95);
        }

        /* Update Notification Toast */
        #update-toast {
            transform: translateY(100px);
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #update-toast.show {
            transform: translateY(0);
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: { 950: '#020617' }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-50 dark:bg-slate-950 transition-colors duration-300 pb-24">

    <!-- Navigasi -->
    <nav class="sticky top-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 px-6 py-4 flex justify-between items-center">
        <h1 class="text-xl font-bold flex items-center gap-2 dark:text-white">
            <i data-lucide="activity" class="text-blue-600"></i> Multitool Medis
        </h1>
        <div class="flex items-center gap-2">
            <div id="update-status" class="text-[10px] font-bold text-slate-400 hidden lg:block">Versi Terbaru</div>
            <button onclick="toggleDarkMode()" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
                <i id="theme-icon" data-lucide="moon" class="text-slate-600 dark:text-amber-400"></i>
            </button>
        </div>
    </nav>

    <div class="max-w-2xl mx-auto mt-6 px-4 space-y-4">

        <!-- SECTION SIRIRAJ STROKE SCORE -->
        <div class="section-container rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden">
            <button onclick="toggleSection('siriraj')" class="w-full p-5 flex items-center justify-between group text-left">
                <div class="flex items-center gap-4">
                    <div class="p-2 rounded-lg bg-slate-50 dark:bg-slate-800"><i data-lucide="brain-circuit" class="text-blue-500"></i></div>
                    <span class="font-black text-slate-800 dark:text-white uppercase tracking-wider text-[12px]">Siriraj Stroke Score (SSS)</span>
                </div>
                <i data-lucide="chevron-down" id="icon-siriraj" class="text-slate-400 transition-transform"></i>
            </button>
            <div id="content-siriraj" class="tab-content p-5 pt-0 border-t border-slate-50 dark:border-slate-800">
                <div class="bg-white dark:bg-slate-900 border-2 border-blue-500/20 rounded-2xl p-6 text-center mb-8 mt-4">
                    <div class="text-xs font-black text-blue-500 uppercase tracking-[0.2em] mb-2">Skor Siriraj</div>
                    <div id="sss-total" class="text-6xl font-black dark:text-white mb-2">0.0</div>
                    <div id="sss-category" class="text-sm font-bold uppercase tracking-wide text-blue-500">Lengkapi data klinis</div>
                </div>
                
                <div class="space-y-6">
                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1 mb-2 block">Derajat Kesadaran</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="setSSS('con', 0)" id="sss-con-0" class="sss-btn-con py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Sadar (0)</button>
                            <button onclick="setSSS('con', 1)" id="sss-con-1" class="sss-btn-con py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Mengantuk (1)</button>
                            <button onclick="setSSS('con', 2)" id="sss-con-2" class="sss-btn-con py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Koma (2)</button>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1 mb-2 block">Muntah (2 Jam)</label>
                            <div class="flex gap-2">
                                <button onclick="setSSS('vom', 0)" id="sss-vom-0" class="sss-btn-vom flex-1 py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Tidak (0)</button>
                                <button onclick="setSSS('vom', 1)" id="sss-vom-1" class="sss-btn-vom flex-1 py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Ya (1)</button>
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1 mb-2 block">Sakit Kepala (2 Jam)</label>
                            <div class="flex gap-2">
                                <button onclick="setSSS('head', 0)" id="sss-head-0" class="sss-btn-head flex-1 py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Tidak (0)</button>
                                <button onclick="setSSS('head', 1)" id="sss-head-1" class="sss-btn-head flex-1 py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Ya (1)</button>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Tekanan Darah Diastolik (mmHg)</label>
                        <input type="number" oninput="calcSSS()" id="sss-dbp" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="Contoh: 90">
                    </div>

                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1 mb-2 block">Marker Atheroma (DM, Obesitas, Claudicatio)</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="setSSS('ath', 0)" id="sss-ath-0" class="sss-btn-ath py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Nol (0)</button>
                            <button onclick="setSSS('ath', 1)" id="sss-ath-1" class="sss-btn-ath py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Satu (1)</button>
                            <button onclick="setSSS('ath', 2)" id="sss-ath-2" class="sss-btn-ath py-2 text-xs font-bold rounded-lg border-2 border-slate-100 dark:border-slate-800 dark:text-slate-300">Dua+ (2)</button>
                        </div>
                    </div>
                </div>
                <button onclick="resetSSS()" class="btn-reset w-full mt-6 flex items-center justify-center gap-2 py-3 text-slate-400 hover:text-blue-500 font-bold transition">
                    <i data-lucide="refresh-cw" size="14"></i> Atur Ulang SSS
                </button>
            </div>
        </div>

        <!-- SECTION APGAR SCORE -->
        <div class="section-container rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden">
            <button onclick="toggleSection('apgar')" class="w-full p-5 flex items-center justify-between group text-left">
                <div class="flex items-center gap-4">
                    <div class="p-2 rounded-lg bg-slate-50 dark:bg-slate-800"><i data-lucide="baby" class="text-purple-500"></i></div>
                    <span class="font-black text-slate-800 dark:text-white uppercase tracking-wider text-[12px]">Skor APGAR</span>
                </div>
                <i data-lucide="chevron-down" id="icon-apgar" class="text-slate-400 transition-transform"></i>
            </button>
            <div id="content-apgar" class="tab-content p-5 pt-0 border-t border-slate-50 dark:border-slate-800">
                <div class="bg-white dark:bg-slate-900 border-2 border-purple-500/20 rounded-2xl p-6 text-center mb-8 mt-4">
                    <div class="text-xs font-black text-purple-500 uppercase tracking-[0.2em] mb-2">Total Skor APGAR</div>
                    <div id="apgar-total" class="text-6xl font-black dark:text-white mb-2">0</div>
                    <div id="apgar-category" class="text-sm font-bold uppercase tracking-wide text-purple-500">Silakan isi semua kriteria</div>
                </div>
                <div class="space-y-8" id="apgar-options-container">
                    <!-- APGAR Options Generated by JS -->
                </div>
                <button onclick="resetApgar()" class="btn-reset w-full mt-8 flex items-center justify-center gap-2 py-3 text-slate-400 hover:text-purple-500 font-bold transition">
                    <i data-lucide="refresh-cw" size="14"></i> Atur Ulang APGAR
                </button>
            </div>
        </div>

        <!-- SECTION GCS -->
        <div class="section-container rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden">
            <button onclick="toggleSection('gcs')" class="w-full p-5 flex items-center justify-between group text-left">
                <div class="flex items-center gap-4">
                    <div class="p-2 rounded-lg bg-slate-50 dark:bg-slate-800"><i data-lucide="brain" class="text-rose-500"></i></div>
                    <span class="font-black text-slate-800 dark:text-white uppercase tracking-wider text-[12px]">Glasgow Coma Scale (GCS)</span>
                </div>
                <i data-lucide="chevron-down" id="icon-gcs" class="text-slate-400 transition-transform"></i>
            </button>
            <div id="content-gcs" class="tab-content p-5 pt-0 border-t border-slate-50 dark:border-slate-800">
                <div class="bg-white dark:bg-slate-900 border-2 border-rose-500/20 rounded-2xl p-6 text-center mb-8 mt-4">
                    <div class="text-xs font-black text-rose-500 uppercase tracking-[0.2em] mb-2">Skor Total GCS</div>
                    <div id="gcs-total" class="text-6xl font-black dark:text-white mb-2">3</div>
                    <div id="gcs-category" class="text-sm font-bold uppercase tracking-wide text-rose-500">Cedera Otak Berat (COB)</div>
                </div>
                <div class="space-y-8" id="gcs-options-container">
                    <!-- GCS Options Generated by JS -->
                </div>
                <button onclick="resetGcs()" class="btn-reset w-full mt-8 flex items-center justify-center gap-2 py-3 text-slate-400 hover:text-rose-500 font-bold transition">
                    <i data-lucide="refresh-cw" size="14"></i> Atur Ulang GCS
                </button>
            </div>
        </div>

        <!-- SECTION TBSA -->
        <div class="section-container rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden">
            <button onclick="toggleSection('tbsa')" class="w-full p-5 flex items-center justify-between group text-left">
                <div class="flex items-center gap-4">
                    <div class="p-2 rounded-lg bg-slate-50 dark:bg-slate-800"><i data-lucide="flame" class="text-orange-500"></i></div>
                    <span class="font-black text-slate-800 dark:text-white uppercase tracking-wider text-[12px]">Luas Luka Bakar (TBSA)</span>
                </div>
                <i data-lucide="chevron-down" id="icon-tbsa" class="text-slate-400 transition-transform"></i>
            </button>
            <div id="content-tbsa" class="tab-content p-5 pt-0 border-t border-slate-50 dark:border-slate-800">
                <div class="flex gap-2 mb-4 mt-4">
                    <button id="btn-adult" onclick="setTbsaMode('adult')" class="flex-1 py-2 rounded-lg text-sm font-bold bg-orange-500 text-white shadow-lg">Dewasa</button>
                    <button id="btn-child" onclick="setTbsaMode('child')" class="flex-1 py-2 rounded-lg text-sm font-bold bg-slate-100 dark:bg-slate-800 dark:text-slate-400">Anak</button>
                </div>
                <div class="bg-orange-500 rounded-2xl p-6 text-white text-center mb-6 shadow-xl shadow-orange-500/20">
                    <p class="text-sm opacity-80 mb-1 font-medium">Total Estimasi TBSA</p>
                    <h2 id="tbsa-total-display" class="text-5xl font-black">0%</h2>
                </div>
                <div id="tbsa-grid" class="grid grid-cols-2 gap-3">
                    <!-- TBSA Parts Generated by JS -->
                </div>
                <button onclick="resetTbsa()" class="btn-reset w-full mt-4 flex items-center justify-center gap-2 py-3 text-slate-400 hover:text-orange-500 font-bold transition">
                    <i data-lucide="refresh-cw" size="14"></i> Atur Ulang TBSA
                </button>
            </div>
        </div>

        <!-- SECTION DOSIS -->
        <div class="section-container rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden">
            <button onclick="toggleSection('dosage')" class="w-full p-5 flex items-center justify-between group text-left">
                <div class="flex items-center gap-4">
                    <div class="p-2 rounded-lg bg-slate-50 dark:bg-slate-800"><i data-lucide="syringe" class="text-cyan-500"></i></div>
                    <span class="font-black text-slate-800 dark:text-white uppercase tracking-wider text-[12px]">Kalkulator Dosis</span>
                </div>
                <i data-lucide="chevron-down" id="icon-dosage" class="text-slate-400 transition-transform"></i>
            </button>
            <div id="content-dosage" class="tab-content p-5 pt-0 border-t border-slate-50 dark:border-slate-800">
                <div class="space-y-4 mt-4">
                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Dosis Instruksi (mg)</label>
                        <input type="number" oninput="calcDosage()" id="dos-ord" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="Contoh: 125">
                    </div>
                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Sediaan Obat (mg)</label>
                        <input type="number" oninput="calcDosage()" id="dos-avail" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="Contoh: 250">
                    </div>
                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Volume Pelarut (mL)</label>
                        <input type="number" oninput="calcDosage()" id="dos-vol" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="Contoh: 5">
                    </div>
                    <div class="bg-cyan-500 p-6 rounded-2xl text-white shadow-lg flex justify-between items-center mt-6">
                        <span class="font-bold">Hasil:</span>
                        <span id="dos-result" class="text-3xl font-black">0.00 mL</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION INFUS -->
        <div class="section-container rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden">
            <button onclick="toggleSection('infus')" class="w-full p-5 flex items-center justify-between group text-left">
                <div class="flex items-center gap-4">
                    <div class="p-2 rounded-lg bg-slate-50 dark:bg-slate-800"><i data-lucide="droplets" class="text-emerald-500"></i></div>
                    <span class="font-black text-slate-800 dark:text-white uppercase tracking-wider text-[12px]">Tetesan Infus (TPM)</span>
                </div>
                <i data-lucide="chevron-down" id="icon-infus" class="text-slate-400 transition-transform"></i>
            </button>
            <div id="content-infus" class="tab-content p-5 pt-0 border-t border-slate-50 dark:border-slate-800">
                <div class="space-y-4 mt-4">
                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Volume Total (mL)</label>
                        <input type="number" oninput="calcInfus()" id="inf-vol" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="500">
                    </div>
                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Waktu (Jam)</label>
                        <input type="number" oninput="calcInfus()" id="inf-time" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="8">
                    </div>
                    <div class="flex gap-2">
                        <button onclick="setInfFactor(20)" id="fac-20" class="flex-1 py-3 rounded-xl font-bold border-2 border-emerald-500 bg-emerald-50 text-emerald-600 transition">Makro (20)</button>
                        <button onclick="setInfFactor(60)" id="fac-60" class="flex-1 py-3 rounded-xl font-bold border-2 border-slate-100 dark:border-slate-800 dark:text-slate-400 transition">Mikro (60)</button>
                    </div>
                    <div class="bg-emerald-500 p-6 rounded-2xl text-white shadow-lg flex justify-between items-center mt-6">
                        <span class="font-bold">Tetesan:</span>
                        <span id="inf-result" class="text-3xl font-black">0 TPM</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION SYRINGE PUMP -->
        <div class="section-container rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden">
            <button onclick="toggleSection('pump')" class="w-full p-5 flex items-center justify-between group text-left">
                <div class="flex items-center gap-4">
                    <div class="p-2 rounded-lg bg-slate-50 dark:bg-slate-800"><i data-lucide="activity" class="text-indigo-500"></i></div>
                    <span class="font-black text-slate-800 dark:text-white uppercase tracking-wider text-[12px]">Vascon Syringe Pump</span>
                </div>
                <i data-lucide="chevron-down" id="icon-pump" class="text-slate-400 transition-transform"></i>
            </button>
            <div id="content-pump" class="tab-content p-5 pt-0 border-t border-slate-50 dark:border-slate-800">
                <div class="grid grid-cols-2 gap-4 mt-4">
                    <div class="col-span-2">
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Dosis (mcg/kgBB/menit)</label>
                        <input type="number" oninput="calcPump()" id="pmp-dose" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="0.1">
                    </div>
                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">BB (kg)</label>
                        <input type="number" oninput="calcPump()" id="pmp-weight" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="70">
                    </div>
                    <div>
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Sediaan (mg)</label>
                        <input type="number" oninput="calcPump()" id="pmp-mass" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="4">
                    </div>
                    <div class="col-span-2">
                        <label class="text-[10px] font-black uppercase tracking-widest text-slate-400 px-1">Total Pelarut (mL)</label>
                        <input type="number" oninput="calcPump()" id="pmp-total" class="w-full bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-xl p-3.5 focus:border-blue-500 focus:outline-none dark:text-white text-sm" placeholder="50">
                    </div>
                </div>
                <div class="bg-indigo-600 p-6 rounded-2xl text-white shadow-lg flex justify-between items-center mt-6">
                    <span class="font-bold">Kecepatan:</span>
                    <span id="pmp-result" class="text-3xl font-black">0.0 mL/Jam</span>
                </div>
            </div>
        </div>

        <!-- PERINGATAN (WARNING BOX) -->
        <div class="mt-8 p-6 rounded-2xl border-2 border-amber-200 dark:border-amber-900/50 bg-amber-50 dark:bg-amber-950/20 shadow-inner">
            <div class="flex items-start gap-4">
                <div class="mt-1 p-2 rounded-full bg-amber-100 dark:bg-amber-900/40">
                    <i data-lucide="alert-triangle" class="text-amber-600 dark:text-amber-500 w-5 h-5"></i>
                </div>
                <div class="space-y-1">
                    <h3 class="text-sm font-black text-amber-800 dark:text-amber-400 uppercase tracking-widest">Peringatan Penting</h3>
                    <p class="text-xs font-medium text-amber-700/80 dark:text-amber-500/80 leading-relaxed">
                        Aplikasi ini hanya alat bantu hitung. Hasil perhitungan <strong>wajib</strong> diperiksa ulang dan disesuaikan dengan teori medis terbaru, protokol rumah sakit, serta kondisi klinis pasien. Segala keputusan medis sepenuhnya merupakan tanggung jawab tenaga kesehatan.
                    </p>
                </div>
            </div>
        </div>

        <!-- REFERENSI & LITERASI -->
        <div class="mt-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden opacity-80 hover:opacity-100 transition-opacity">
            <button onclick="toggleSection('refs')" class="w-full p-4 flex items-center justify-between group text-left">
                <div class="flex items-center gap-3">
                    <div class="p-1.5 rounded-lg bg-slate-50 dark:bg-slate-800"><i data-lucide="book-open" class="text-slate-400 w-4 h-4"></i></div>
                    <span class="text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-[0.2em]">Referensi & Sumber Literasi</span>
                </div>
                <i data-lucide="chevron-down" id="icon-refs" class="text-slate-400 transition-transform w-4 h-4"></i>
            </button>
            <div id="content-refs" class="tab-content p-5 pt-0 border-t border-slate-50 dark:border-slate-800">
                <ul class="text-[11px] text-slate-600 dark:text-slate-400 space-y-3 leading-relaxed list-disc pl-4 mt-4">
                    <li><strong>Siriraj Stroke Score (SSS):</strong> Poungvarin N, et al. BMJ. 1991.</li>
                    <li><strong>GCS (Glasgow Coma Scale):</strong> Teasdale G, Jennett B. 1974. Lancet.</li>
                    <li><strong>Skor APGAR:</strong> Apgar V. 1953. American Academy of Pediatrics & ACOG.</li>
                    <li><strong>TBSA (Rule of Nines):</strong> Wallace AB. 1951. Lancet. Standar ATLS edisi ke-10.</li>
                    <li><strong>Kalkulasi Klinis:</strong> Bermel, Mary A. <i>Dosage Calculations.</i> Cengage Learning.</li>
                </ul>
            </div>
        </div>

    </div>

    <!-- Update Toast Notification -->
    <div id="update-toast" class="fixed bottom-6 left-1/2 -translate-x-1/2 z-[60] w-[90%] max-w-md bg-slate-900 text-white p-4 rounded-2xl shadow-2xl flex items-center justify-between border border-slate-700">
        <div class="flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg animate-pulse">
                <i data-lucide="cloud-download" class="w-5 h-5 text-white"></i>
            </div>
            <div>
                <p class="text-xs font-bold">Pembaruan Tersedia</p>
                <p class="text-[10px] text-slate-400">Versi terbaru telah dirilis di GitHub.</p>
            </div>
        </div>
        <button onclick="window.location.reload(true)" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-xl text-[11px] font-black uppercase tracking-wider transition-colors">
            Muat Ulang
        </button>
    </div>

    <script>
        // --- AUTO UPDATE LOGIC ---
        // GANTI INI DENGAN REPO ANDA SENDIRI
        const GITHUB_REPO = "igdrsdh/Multitool-IGD"; // Format: username/repo
        const CURRENT_VERSION_HASH = "local-dev"; // Akan otomatis dibandingkan dengan hash commit terbaru

        async function checkForUpdates() {
            if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") return;
            
            try {
                // Mengambil info commit terakhir dari branch main menggunakan API GitHub
                const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/commits/main`, {
                    headers: { 'Accept': 'application/vnd.github.v3+json' }
                });
                
                if (!response.ok) return;
                
                const data = await response.json();
                const latestHash = data.sha;
                const localHash = localStorage.getItem('app_version_hash');

                // Jika ini kunjungan pertama, simpan hash saat ini
                if (!localHash) {
                    localStorage.setItem('app_version_hash', latestHash);
                    return;
                }

                // Jika hash berbeda, tampilkan notifikasi update
                if (localHash !== latestHash) {
                    document.getElementById('update-toast').classList.add('show');
                    document.getElementById('update-status').innerText = "Update Tersedia!";
                    document.getElementById('update-status').classList.remove('text-slate-400');
                    document.getElementById('update-status').classList.add('text-orange-500');
                    // Simpan hash baru (akan aktif setelah reload)
                    localStorage.setItem('app_version_hash', latestHash);
                }
            } catch (error) {
                console.error("Update check failed", error);
            }
        }

        // Jalankan pengecekan saat load dan setiap 10 menit
        setTimeout(checkForUpdates, 3000);
        setInterval(checkForUpdates, 600000);

        // --- DATA & STATE ---
        let darkMode = false;
        let gcs = { e: 1, v: 1, m: 1 };
        let apgar = { appearance: null, pulse: null, grimace: null, activity: null, respiration: null };
        let tbsaMode = 'adult';
        let tbsaParts = { head: 0, trunkFront: 0, trunkBack: 0, armL: 0, armR: 0, perineum: 0, legL: 0, legR: 0 };
        let infFactor = 20;
        let sssData = { con: null, vom: null, head: null, ath: null };

        const apgarLabels = {
            appearance: { label: "Appearance (Warna Kulit)", options: [
                { val: 0, text: "Seluruh tubuh biru atau pucat" },
                { val: 1, text: "Tubuh kemerahan, ekstremitas biru" },
                { val: 2, text: "Seluruh tubuh kemerahan" }
            ]},
            pulse: { label: "Pulse (Denyut Jantung)", options: [
                { val: 0, text: "Tidak ada" },
                { val: 1, text: "< 100 kali per menit" },
                { val: 2, text: "> 100 kali per menit" }
            ]},
            grimace: { label: "Grimace (Refleks terhadap rangsang)", options: [
                { val: 0, text: "Tidak ada respon" },
                { val: 1, text: "Meringis/gerakan sedikit" },
                { val: 2, text: "Menangis kuat, batuk, atau bersin" }
            ]},
            activity: { label: "Activity (Tonus Otot)", options: [
                { val: 0, text: "Lumpuh/lemas" },
                { val: 1, text: "Ekstremitas sedikit fleksi" },
                { val: 2, text: "Gerakan aktif" }
            ]},
            respiration: { label: "Respiration (Usaha Napas)", options: [
                { val: 0, text: "Tidak ada" },
                { val: 1, text: "Lemah/tidak teratur" },
                { val: 2, text: "Menangis kuat" }
            ]}
        };

        const gcsLabels = {
            e: [
                { val: 4, text: "Spontan" },
                { val: 3, text: "Dengan perintah suara" },
                { val: 2, text: "Dengan rangsang nyeri" },
                { val: 1, text: "Tidak ada respon" }
            ],
            v: [
                { val: 5, text: "Orientasi baik & senyum" },
                { val: 4, text: "Bingung (Disorientasi)" },
                { val: 3, text: "Kata-kata tidak tepat" },
                { val: 2, text: "Suara tanpa arti (mengerang)" },
                { val: 1, text: "Tidak ada respon" }
            ],
            m: [
                { val: 6, text: "Mengikuti perintah" },
                { val: 5, text: "Melokalisir nyeri" },
                { val: 4, text: "Menghindari nyeri (Withdrawal)" },
                { val: 3, text: "Fleksi abnormal (Dekortikasi)" },
                { val: 2, text: "Ekstensi abnormal (Deserebrasi)" },
                { val: 1, text: "Tidak ada respon" }
            ]
        };

        const tbsaValues = {
            adult: { head: 9, trunkFront: 18, trunkBack: 18, armL: 9, armR: 9, perineum: 1, legL: 18, legR: 18 },
            child: { head: 18, trunkFront: 18, trunkBack: 18, armL: 9, armR: 9, perineum: 1, legL: 13.5, legR: 13.5 }
        };

        const tbsaNames = {
            head: "Kepala", trunkFront: "Dada & Perut", trunkBack: "Punggung", armL: "Lengan Kiri",
            armR: "Lengan Kanan", perineum: "Perineum", legL: "Tungkai Kiri", legR: "Tungkai Kanan"
        };

        // --- INITIALIZATION ---
        window.onload = () => {
            renderApgar();
            renderGcs();
            renderTbsaGrid();
            lucide.createIcons();
            
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        };

        // --- UI FUNCTIONS ---
        function toggleDarkMode() {
            darkMode = !darkMode;
            document.documentElement.classList.toggle('dark');
            const icon = document.getElementById('theme-icon');
            icon.setAttribute('data-lucide', darkMode ? 'sun' : 'moon');
            lucide.createIcons();
        }

        function toggleSection(id) {
            const content = document.getElementById(`content-${id}`);
            const icon = document.getElementById(`icon-${id}`);
            const isActive = content.classList.contains('active');
            
            if (isActive) {
                content.classList.remove('active');
                icon.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('active');
                icon.style.transform = 'rotate(180deg)';
            }
        }

        // --- SIRIRAJ LOGIC ---
        function setSSS(key, val) {
            sssData[key] = val;
            document.querySelectorAll(`.sss-btn-${key}`).forEach(btn => {
                btn.classList.remove('border-blue-500', 'bg-blue-50', 'text-blue-600', 'dark:bg-blue-900/20');
            });
            const activeBtn = document.getElementById(`sss-${key}-${val}`);
            activeBtn.classList.add('border-blue-500', 'bg-blue-50', 'text-blue-600', 'dark:bg-blue-900/20');
            calcSSS();
        }

        function calcSSS() {
            const dbp = parseFloat(document.getElementById('sss-dbp').value) || 0;
            const totalEl = document.getElementById('sss-total');
            const catEl = document.getElementById('sss-category');

            if (sssData.con === null || sssData.vom === null || sssData.head === null || sssData.ath === null || dbp <= 0) {
                totalEl.innerText = "0.0";
                catEl.innerText = "Lengkapi data klinis";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-blue-500";
                return;
            }

            const score = (2.5 * sssData.con) + (2 * sssData.vom) + (2 * sssData.head) + (0.1 * dbp) - (3 * sssData.ath) - 12;
            totalEl.innerText = score.toFixed(1);

            if (score > 1) {
                catEl.innerText = "STROKE HEMORAGIK (PERDARAHAN)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-rose-500";
            } else if (score < -1) {
                catEl.innerText = "STROKE ISKEMIK (INFARK)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-emerald-500";
            } else {
                catEl.innerText = "HASIL MERAGUKAN (EQUIVOCAL)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-amber-500";
            }
        }

        function resetSSS() {
            sssData = { con: null, vom: null, head: null, ath: null };
            document.getElementById('sss-dbp').value = '';
            document.querySelectorAll('[id^="sss-btn-"], [class*="sss-btn-"]').forEach(btn => {
                btn.classList.remove('border-blue-500', 'bg-blue-50', 'text-blue-600', 'dark:bg-blue-900/20');
            });
            calcSSS();
        }

        // --- APGAR LOGIC ---
        function renderApgar() {
            const container = document.getElementById('apgar-options-container');
            container.innerHTML = '';

            Object.keys(apgarLabels).forEach(key => {
                const section = apgarLabels[key];
                let html = `
                    <div class="space-y-4">
                        <div class="flex justify-between items-center px-1">
                            <span class="text-sm font-black dark:text-slate-200 uppercase tracking-wide border-l-4 border-purple-500 pl-2">${section.label}</span>
                            <span class="text-[10px] font-black bg-purple-100 text-purple-600 dark:bg-purple-900/40 dark:text-purple-400 px-3 py-1 rounded-full">Poin: ${apgar[key] !== null ? apgar[key] : '-'}</span>
                        </div>
                        <div class="grid grid-cols-1 gap-2">
                `;
                
                section.options.forEach(opt => {
                    const isSelected = apgar[key] === opt.val;
                    html += `
                        <button onclick="setApgar('${key}', ${opt.val})" class="flex items-center justify-between p-3.5 rounded-xl border-2 transition-all ${isSelected ? 'border-purple-500 bg-purple-50 dark:bg-purple-900/20 shadow-sm' : 'border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900'}">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full flex items-center justify-center font-black ${isSelected ? 'bg-purple-500 text-white' : 'bg-slate-100 dark:bg-slate-800 text-slate-400'}">${opt.val}</div>
                                <span class="text-xs font-bold ${isSelected ? 'text-purple-700 dark:text-purple-300' : 'text-slate-600 dark:text-slate-400'}">${opt.text}</span>
                            </div>
                        </button>
                    `;
                });
                
                html += `</div></div>`;
                container.innerHTML += html;
            });
            updateApgarTotal();
        }

        function setApgar(key, val) {
            apgar[key] = val;
            renderApgar();
        }

        function resetApgar() {
            apgar = { appearance: null, pulse: null, grimace: null, activity: null, respiration: null };
            renderApgar();
        }

        function updateApgarTotal() {
            const values = Object.values(apgar);
            const allSelected = values.every(v => v !== null);
            const total = values.reduce((a, b) => (a || 0) + (b || 0), 0);
            
            const totalEl = document.getElementById('apgar-total');
            const catEl = document.getElementById('apgar-category');

            if (!allSelected) {
                totalEl.innerText = total;
                catEl.innerText = "Silakan isi semua kriteria";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-slate-400";
                return;
            }

            totalEl.innerText = total;
            if (total >= 7) {
                catEl.innerText = "Normal (Vigorous Baby)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-emerald-500";
            } else if (total >= 4) {
                catEl.innerText = "Asfiksia Sedang (Mild/Moderate)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-amber-500";
            } else {
                catEl.innerText = "Asfiksia Berat (Severe)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-rose-500 font-black";
            }
        }

        // --- GCS LOGIC ---
        function renderGcs() {
            const container = document.getElementById('gcs-options-container');
            container.innerHTML = '';
            
            const sections = [
                { key: 'e', label: 'Eye (Respon Mata)' },
                { key: 'v', label: 'Verbal (Respon Suara)' },
                { key: 'm', label: 'Motorik (Respon Gerak)' }
            ];

            sections.forEach(s => {
                let html = `
                    <div class="space-y-4">
                        <div class="flex justify-between items-center px-1">
                            <span class="text-sm font-black dark:text-slate-200 uppercase tracking-wide border-l-4 border-rose-500 pl-2">${s.label}</span>
                            <span class="text-[10px] font-black bg-rose-100 text-rose-600 dark:bg-rose-900/40 dark:text-rose-400 px-3 py-1 rounded-full" id="skor-${s.key}">Skor: ${gcs[s.key]}</span>
                        </div>
                        <div class="grid grid-cols-1 gap-2">
                `;
                
                gcsLabels[s.key].forEach(opt => {
                    const isSelected = gcs[s.key] === opt.val;
                    html += `
                        <button onclick="setGcs('${s.key}', ${opt.val})" class="flex items-center justify-between p-3.5 rounded-xl border-2 transition-all ${isSelected ? 'border-rose-500 bg-rose-50 dark:bg-rose-900/20 shadow-sm' : 'border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900'}">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full flex items-center justify-center font-black ${isSelected ? 'bg-rose-500 text-white' : 'bg-slate-100 dark:bg-slate-800 text-slate-400'}">${opt.val}</div>
                                <span class="text-xs font-bold ${isSelected ? 'text-rose-700 dark:text-rose-300' : 'text-slate-600 dark:text-slate-400'}">${opt.text}</span>
                            </div>
                        </button>
                    `;
                });
                
                html += `</div></div>`;
                container.innerHTML += html;
            });
            updateGcsTotal();
        }

        function setGcs(key, val) {
            gcs[key] = val;
            renderGcs();
        }

        function resetGcs() {
            gcs = { e: 1, v: 1, m: 1 };
            renderGcs();
        }

        function updateGcsTotal() {
            const total = gcs.e + gcs.v + gcs.m;
            document.getElementById('gcs-total').innerText = total;
            const catEl = document.getElementById('gcs-category');
            if (total >= 13) {
                catEl.innerText = "Cedera Otak Ringan (COR)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-emerald-500";
            } else if (total >= 9) {
                catEl.innerText = "Cedera Otak Sedang (COS)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-amber-500";
            } else {
                catEl.innerText = "Cedera Otak Berat (COB)";
                catEl.className = "text-sm font-bold uppercase tracking-wide text-rose-500 font-black";
            }
        }

        // --- TBSA LOGIC ---
        function setTbsaMode(mode) {
            tbsaMode = mode;
            document.getElementById('btn-adult').className = mode === 'adult' ? 'flex-1 py-2 rounded-lg text-sm font-bold bg-orange-500 text-white shadow-lg' : 'flex-1 py-2 rounded-lg text-sm font-bold bg-slate-100 dark:bg-slate-800 dark:text-slate-400';
            document.getElementById('btn-child').className = mode === 'child' ? 'flex-1 py-2 rounded-lg text-sm font-bold bg-orange-500 text-white shadow-lg' : 'flex-1 py-2 rounded-lg text-sm font-bold bg-slate-100 dark:bg-slate-800 dark:text-slate-400';
            renderTbsaGrid();
        }

        function renderTbsaGrid() {
            const grid = document.getElementById('tbsa-grid');
            grid.innerHTML = '';
            let total = 0;
            
            Object.keys(tbsaParts).forEach(key => {
                const multiplier = tbsaParts[key];
                const value = tbsaValues[tbsaMode][key] * multiplier;
                total += value;
                
                grid.innerHTML += `
                    <button onclick="toggleTbsaPart('${key}')" class="p-4 rounded-xl border-2 transition-all text-left ${multiplier > 0 ? 'border-orange-500 bg-orange-50 dark:bg-orange-950/30' : 'border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900'}">
                        <div class="flex justify-between items-start mb-1">
                            <span class="text-[10px] font-bold uppercase tracking-wider text-slate-400">${tbsaNames[key]}</span>
                            <span class="text-[10px] font-bold px-1.5 py-0.5 rounded ${multiplier > 0 ? 'bg-orange-500 text-white' : 'bg-slate-200 dark:bg-slate-700'}">${multiplier*100}%</span>
                        </div>
                        <div class="text-xl font-black dark:text-white">${value.toFixed(1)}%</div>
                    </button>
                `;
            });
            document.getElementById('tbsa-total-display').innerText = total + '%';
        }

        function toggleTbsaPart(key) {
            const cycles = [0, 0.5, 1];
            const current = tbsaParts[key];
            tbsaParts[key] = cycles[(cycles.indexOf(current) + 1) % 3];
            renderTbsaGrid();
        }

        function resetTbsa() {
            Object.keys(tbsaParts).forEach(k => tbsaParts[k] = 0);
            renderTbsaGrid();
        }

        // --- DOSAGE LOGIC ---
        function calcDosage() {
            const ord = parseFloat(document.getElementById('dos-ord').value) || 0;
            const avail = parseFloat(document.getElementById('dos-avail').value) || 0;
            const vol = parseFloat(document.getElementById('dos-vol').value) || 0;
            const res = avail > 0 ? (ord / avail) * vol : 0;
            document.getElementById('dos-result').innerText = res.toFixed(2) + ' mL';
        }

        // --- INFUSION LOGIC ---
        function setInfFactor(f) {
            infFactor = f;
            document.getElementById('fac-20').className = f === 20 ? 'flex-1 py-3 rounded-xl font-bold border-2 border-emerald-500 bg-emerald-50 text-emerald-600' : 'flex-1 py-3 rounded-xl font-bold border-2 border-slate-100 dark:border-slate-800 dark:text-slate-400';
            document.getElementById('fac-60').className = f === 60 ? 'flex-1 py-3 rounded-xl font-bold border-2 border-emerald-500 bg-emerald-50 text-emerald-600' : 'flex-1 py-3 rounded-xl font-bold border-2 border-slate-100 dark:border-slate-800 dark:text-slate-400';
            calcInfus();
        }

        function calcInfus() {
            const vol = parseFloat(document.getElementById('inf-vol').value) || 0;
            const time = parseFloat(document.getElementById('inf-time').value) || 0;
            const res = time > 0 ? Math.round((vol * infFactor) / (time * 60)) : 0;
            document.getElementById('inf-result').innerText = res + ' TPM';
        }

        // --- SYRINGE PUMP LOGIC ---
        function calcPump() {
            const dose = parseFloat(document.getElementById('pmp-dose').value) || 0;
            const weight = parseFloat(document.getElementById('pmp-weight').value) || 0;
            const mass = parseFloat(document.getElementById('pmp-mass').value) || 0;
            const totalVol = parseFloat(document.getElementById('pmp-total').value) || 0;
            
            if (mass > 0 && totalVol > 0) {
                const concentration = (mass * 1000) / totalVol;
                const res = (dose * weight * 60) / concentration;
                document.getElementById('pmp-result').innerText = res.toFixed(1) + ' mL/Jam';
            } else {
                document.getElementById('pmp-result').innerText = '0.0 mL/Jam';
            }
        }
    </script>
</body>
</html>

