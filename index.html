<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multitool Medis Klinis (TBSA, GCS, Dosis & Infus)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Base Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fc; /* Soft Light Blue-Gray */
        }
        
        /* --- UNIFORM ACCORDION HEADER HEIGHT --- */
        .accordion-header {
            min-height: 4.25rem; /* Menjamin tinggi yang seragam (sekitar h-17) */
        }
        /* PENTING: Semua header menggunakan p-4 dan flex items-center, 
           min-height ini mencegah ketidakseragaman akibat text wrapping pada judul panjang. */

        /* --- TBSA Styles (Orange) --- */
        .tbsa-header.active-header { background-color: #ffedd5; } /* Orange-100 */
        .tbsa-part-card.selected {
            border-color: #f97316; /* Orange-600 for border */
            background-color: #fff7ed; /* Orange-50 */
            box-shadow: 0 10px 15px -3px rgba(249, 115, 22, 0.2), 0 4px 6px -4px rgba(249, 115, 22, 0.1);
        }
        .tbsa-part-card.selected .part-percentage {
            color: #c2410c; /* Darker Orange */
            font-weight: 700;
        }
        .tbsa-critical {
             background-color: #b91c1c; /* Deep Red-700: Alert for Critical TBSA */
        }
        
        /* --- GCS Styles (Rose/Red) --- */
        .gcs-header.active-header { background-color: #ffe4e6; } /* Rose-100 */
        .gcs-score-card {
            cursor: pointer;
            transition: all 0.1s;
            line-height: 1.2;
        }
        .gcs-score-card.active-score {
            background-color: #e11d48; /* Rose-600 for GCS Selection */
            color: white;
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(225, 29, 72, 0.3);
        }

        /* --- Dosis Styles (Cyan) --- */
        .dosis-header.active-header { background-color: #cfecf4; } /* Cyan-100 */

        /* --- Infus Styles (Emerald) --- */
        .infus-header.active-header { background-color: #d1fae5; } /* Emerald-100 */

        /* --- Dosis Vaso Styles (Red) --- */
        .vaso-header.active-header { background-color: #fee2e2; } /* Red-100 */
        
        /* --- Dosis Nica Styles (Indigo) --- */
        .nica-header.active-header { background-color: #e0e7ff; } /* Indigo-100 */

        /* Input Styles: Tetap netral/standar untuk konsistensi */
        .calc-input {
            border: 1px solid #d1d5db;
            padding: 10px;
            border-radius: 8px;
            width: 100%;
            transition: border-color 0.2s;
        }
        .calc-input:focus {
            border-color: #0284c7; /* Sky-600 on focus */
            outline: none;
        }
        
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-3xl mx-auto bg-white p-6 md:p-8 rounded-2xl shadow-2xl">
        <h1 class="text-3xl font-extrabold text-gray-800 mb-2">ðŸ©º Multitool Medis Klinis</h1>
        <p class="text-gray-500 mb-6">Pilih kalkulator yang Anda butuhkan di bawah ini.</p>

        <div class="space-y-4">
            
            <div class="accordion-item border border-gray-300 rounded-xl overflow-hidden">
                <button class="accordion-header tbsa-header flex justify-between items-center w-full p-4 bg-gray-100 hover:bg-orange-50 font-bold transition duration-200 text-left" data-target="calculatorTBSA">
                    <span class="text-lg">ðŸ”¥ Kalkulator Luas Luka Bakar (TBSA)</span>
                    <span class="accordion-icon transform transition duration-300 text-orange-600">â–¼</span>
                </button>
                <div id="calculatorTBSA" class="accordion-content p-4 bg-white">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Kalkulator Luas Luka Bakar (TBSA)</h2>
                    <blockquote class="border-l-4 border-orange-500 bg-orange-50 p-3 mb-6 text-sm text-orange-700">
                        **Penting:** Aplikasi ini HANYA alat bantu perkiraan. TIDAK menggantikan penilaian medis profesional.
                    </blockquote>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-semibold text-gray-700 mb-2">Pilih Metode Perhitungan:</h3>
                        <div class="flex space-x-4">
                            <button id="modeAdult" class="tbsa-mode-btn px-4 py-2 rounded-lg font-bold transition duration-150 border-2 border-orange-500 bg-orange-500 text-white shadow-md">
                                Dewasa (Rule of Nines)
                            </button>
                            <button id="modeChild" class="tbsa-mode-btn px-4 py-2 rounded-lg font-bold transition duration-150 border-2 border-gray-300 bg-gray-100 text-gray-700 hover:bg-orange-50 hover:border-orange-500">
                                Anak (Lund-Browder)
                            </button>
                        </div>
                    </div>
                    
                    <div id="tbsaBox" class="bg-orange-500 p-4 md:p-6 rounded-xl text-white shadow-xl mb-8 transition duration-300">
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-semibold">Total Luas Luka Bakar (TBSA)</span>
                            <span id="totalTBSA" class="text-2xl font-black">0%</span>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Pilih Bagian Tubuh & Persentase:</h3>
                        <p id="methodNote" class="text-sm text-gray-500 italic mb-3">Nilai didasarkan pada Rule of Nines untuk Dewasa (9%, 18%, 1%).</p>
                        <p class="text-sm text-gray-500 italic">Klik pada kartu bagian tubuh yang terbakar. Klik berulang kali untuk memilih persentase (0%, 50%, atau 100%).</p>
                    </div>

                    <div id="bodyPartsGrid" class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <div class="part-card tbsa-part-card bg-gray-100 p-4 rounded-lg shadow-md" data-part-id="head" data-value="9" data-current-percent="0" data-value-adult="9" data-value-child="18">
                            <span class="text-2xl" role="img" aria-label="head">ðŸ‘¤</span>
                            <p class="font-bold text-gray-800 mt-1">Kepala & Leher</p>
                            <p class="text-sm text-gray-600 part-full-value">Nilai Penuh: 9%</p>
                            <p class="text-lg font-semibold text-orange-500 mt-1 part-percentage">0%</p>
                        </div>
                        <div class="part-card tbsa-part-card bg-gray-100 p-4 rounded-lg shadow-md" data-part-id="trunk-front" data-value="18" data-current-percent="0" data-value-adult="18" data-value-child="18">
                            <span class="text-2xl" role="img" aria-label="body-front">ðŸ‘•</span>
                            <p class="font-bold text-gray-800 mt-1">Badan Depan</p>
                            <p class="text-sm text-gray-600 part-full-value">Nilai Penuh: 18%</p>
                            <p class="text-lg font-semibold text-orange-500 mt-1 part-percentage">0%</p>
                        </div>
                        <div class="part-card tbsa-part-card bg-gray-100 p-4 rounded-lg shadow-md" data-part-id="trunk-back" data-value="18" data-current-percent="0" data-value-adult="18" data-value-child="18">
                            <span class="text-2xl" role="img" aria-label="body-back">ðŸ”™</span>
                            <p class="font-bold text-gray-800 mt-1">Badan Belakang</p>
                            <p class="text-sm text-gray-600 part-full-value">Nilai Penuh: 18%</p>
                            <p class="text-lg font-semibold text-orange-500 mt-1 part-percentage">0%</p>
                        </div>
                        <div class="part-card tbsa-part-card bg-gray-100 p-4 rounded-lg shadow-md" data-part-id="arm-left" data-value="9" data-current-percent="0" data-value-adult="9" data-value-child="9">
                            <span class="text-2xl" role="img" aria-label="arm-left">ðŸ¤š</span>
                            <p class="font-bold text-gray-800 mt-1">Lengan Kiri</p>
                            <p class="text-sm text-gray-600 part-full-value">Nilai Penuh: 9%</p>
                            <p class="text-lg font-semibold text-orange-500 mt-1 part-percentage">0%</p>
                        </div>
                        <div class="part-card tbsa-part-card bg-gray-100 p-4 rounded-lg shadow-md" data-part-id="arm-right" data-value="9" data-current-percent="0" data-value-adult="9" data-value-child="9">
                            <span class="text-2xl" role="img" aria-label="arm-right">ðŸ¤š</span>
                            <p class="font-bold text-gray-800 mt-1">Lengan Kanan</p>
                            <p class="text-sm text-gray-600 part-full-value">Nilai Penuh: 9%</p>
                            <p class="text-lg font-semibold text-orange-500 mt-1 part-percentage">0%</p>
                        </div>
                        <div class="part-card tbsa-part-card bg-gray-100 p-4 rounded-lg shadow-md" data-part-id="perineum" data-value="1" data-current-percent="0" data-value-adult="1" data-value-child="1">
                            <span class="text-2xl" role="img" aria-label="perineum">ðŸ‘–</span>
                            <p class="font-bold text-gray-800 mt-1">Perineum</p>
                            <p class="text-sm text-gray-600 part-full-value">Nilai Penuh: 1%</p>
                            <p class="text-lg font-semibold text-orange-500 mt-1 part-percentage">0%</p>
                        </div>
                        <div class="part-card tbsa-part-card bg-gray-100 p-4 rounded-lg shadow-md" data-part-id="leg-left" data-value="18" data-current-percent="0" data-value-adult="18" data-value-child="13.5">
                            <span class="text-2xl" role="img" aria-label="leg-left">ðŸ¦µ</span>
                            <p class="font-bold text-gray-800 mt-1">Kaki Kiri</p>
                            <p class="text-sm text-gray-600 part-full-value">Nilai Penuh: 18%</p>
                            <p class="text-lg font-semibold text-orange-500 mt-1 part-percentage">0%</p>
                        </div>
                        <div class="part-card tbsa-part-card bg-gray-100 p-4 rounded-lg shadow-md" data-part-id="leg-right" data-value="18" data-current-percent="0" data-value-adult="18" data-value-child="13.5">
                            <span class="text-2xl" role="img" aria-label="leg-right">ðŸ¦µ</span>
                            <p class="font-bold text-gray-800 mt-1">Kaki Kanan</p>
                            <p class="text-sm text-gray-600 part-full-value">Nilai Penuh: 18%</p>
                            <p class="text-lg font-semibold text-orange-500 mt-1 part-percentage">0%</p>
                        </div>
                    </div>
                    
                    <button id="resetTBSA" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl mt-8 transition duration-150 shadow-md hover:shadow-lg">
                        <span role="img" aria-label="emoji" class="mr-1">ðŸ”„</span> Reset Pilihan TBSA
                    </button>
                </div>
            </div>

            <div class="accordion-item border border-gray-300 rounded-xl overflow-hidden">
                <button class="accordion-header gcs-header flex justify-between items-center w-full p-4 bg-gray-100 hover:bg-rose-50 font-bold transition duration-200 text-left" data-target="calculatorGCS">
                    <span class="text-lg">ðŸ§  Kalkulator Glasgow Coma Scale (GCS)</span>
                    <span class="accordion-icon transform transition duration-300 text-rose-600">â–¼</span>
                </button>
                <div id="calculatorGCS" class="accordion-content p-4 bg-white hidden">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Kalkulator Glasgow Coma Scale (GCS)</h2>
                    <p class="text-gray-500 mb-4">Pilih respons terbaik pasien di setiap kategori (E, V, M).</p>
                    
                    <div class="bg-rose-600 p-4 md:p-6 rounded-xl text-white shadow-xl mb-8 transition duration-300">
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-semibold">Total Skor GCS (E + V + M)</span>
                            <span id="totalGCS" class="text-2xl font-black">3</span>
                        </div>
                        <p id="gcsInterpretation" class="text-sm mt-2 font-medium"></p>
                    </div>

                    <h3 class="text-xl font-semibold text-gray-700 mb-3">1. Respon Membuka Mata (E: 1-4)</h3>
                    <div id="gcsE" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center" data-category="E" data-score="4" data-label="Spontan">
                            <span class="font-bold text-xl block">4</span>
                            <span class="text-xs">Spontan</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center" data-category="E" data-score="3" data-label="Terhadap Suara">
                            <span class="font-bold text-xl block">3</span>
                            <span class="text-xs">Terhadap Suara</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center" data-category="E" data-score="2" data-label="Terhadap Nyeri">
                            <span class="font-bold text-xl block">2</span>
                            <span class="text-xs">Terhadap Nyeri</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center active-score" data-category="E" data-score="1" data-label="Tidak Ada">
                            <span class="font-bold text-xl block">1</span>
                            <span class="text-xs">Tidak Ada</span>
                        </div>
                    </div>
                    <p id="gcsELabel" class="text-sm text-gray-600 mb-6 font-medium text-center">Respon saat ini: Tidak Ada (1)</p>

                    <h3 class="text-xl font-semibold text-gray-700 mb-3">2. Respon Verbal (V: 1-5)</h3>
                    <div id="gcsV" class="grid grid-cols-3 md:grid-cols-5 gap-4 mb-6">
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center" data-category="V" data-score="5" data-label="Orientasi Baik">
                            <span class="font-bold text-xl block">5</span>
                            <span class="text-xs">Orientasi Baik</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center" data-category="V" data-score="4" data-label="Bingung">
                            <span class="font-bold text-xl block">4</span>
                            <span class="text-xs">Bingung</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center" data-category="V" data-score="3" data-label="Kata-kata Tidak Sesuai">
                            <span class="font-bold text-xl block">3</span>
                            <span class="text-xs">Kata-kata Tak Sesuai</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center" data-category="V" data-score="2" data-label="Suara Tak Jelas">
                            <span class="font-bold text-xl block">2</span>
                            <span class="text-xs">Suara Tak Jelas</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-3 rounded-lg text-center active-score" data-category="V" data-score="1" data-label="Tidak Ada">
                            <span class="font-bold text-xl block">1</span>
                            <span class="text-xs">Tidak Ada</span>
                        </div>
                    </div>
                    <p id="gcsVLabel" class="text-sm text-gray-600 mb-6 font-medium text-center">Respon saat ini: Tidak Ada (1)</p>
                    
                    <h3 class="text-xl font-semibold text-gray-700 mb-3">3. Respon Motorik (M: 1-6)</h3>
                    <div id="gcsM" class="grid grid-cols-3 md:grid-cols-6 gap-2 mb-6 text-center">
                        <div class="gcs-score-card bg-gray-100 p-2 rounded-lg" data-category="M" data-score="6" data-label="Ikuti Perintah">
                            <span class="font-bold text-xl block">6</span>
                            <span class="text-xs">Ikuti Perintah</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-2 rounded-lg" data-category="M" data-score="5" data-label="Melokalisir Nyeri">
                            <span class="font-bold text-xl block">5</span>
                            <span class="text-xs">Melokalisir</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-2 rounded-lg" data-category="M" data-score="4" data-label="Menarik Diri dari Nyeri">
                            <span class="font-bold text-xl block">4</span>
                            <span class="text-xs">Menarik Diri dari Nyeri</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-2 rounded-lg" data-category="M" data-score="3" data-label="Fleksi Abnormal (Dekortikasi)">
                            <span class="font-bold text-xl block">3</span>
                            <span class="text-xs">Fleksi Abnormal</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-2 rounded-lg" data-category="M" data-score="2" data-label="Ekstensi Abnormal (Deserebrasi)">
                            <span class="font-bold text-xl block">2</span>
                            <span class="text-xs">Ekstensi Abnormal</span>
                        </div>
                        <div class="gcs-score-card bg-gray-100 p-2 rounded-lg active-score" data-category="M" data-score="1" data-label="Tidak Ada">
                            <span class="font-bold text-xl block">1</span>
                            <span class="text-xs">Tidak Ada</span>
                        </div>
                    </div>
                    <p id="gcsMLabel" class="text-sm text-gray-600 mb-6 font-medium text-center">Respon saat ini: Tidak Ada (1)</p>

                    <button id="resetGCS" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl mt-8 transition duration-150 shadow-md hover:shadow-lg">
                        <span role="img" aria-label="emoji" class="mr-1">ðŸ”„</span> Reset Pilihan GCS
                    </button>
                </div>
            </div>
            
            <div class="accordion-item border border-gray-300 rounded-xl overflow-hidden">
                <button class="accordion-header dosis-header flex justify-between items-center w-full p-4 bg-gray-100 hover:bg-cyan-50 font-bold transition duration-200 text-left" data-target="calculatorDosis">
                    <span class="text-lg">ðŸ’‰ Kalkulator Dosis Obat (Volume Injeksi)</span>
                    <span class="accordion-icon transform transition duration-300 text-cyan-600">â–¼</span>
                </button>
                <div id="calculatorDosis" class="accordion-content p-4 bg-white hidden">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">ðŸ’‰ Kalkulator Dosis Obat (Volume Injeksi)</h2>
                    <p class="text-gray-500 mb-4">Hitung volume (mL) yang dibutuhkan untuk dosis injeksi yang diresepkan.</p>

                    <blockquote class="border-l-4 border-cyan-500 bg-cyan-50 p-3 mb-6 text-sm text-cyan-700">
                        **Peringatan:** Selalu verifikasi perhitungan dosis dengan standar institusi dan pastikan satuan (mg/mL) sudah dikonversi dengan benar.
                    </blockquote>
                    
                    <div class="space-y-4">
                        <div>
                            <label for="doseOrdered" class="block text-sm font-medium text-gray-700 mb-1">Dosis yang Dikehendaki (mg):</label>
                            <input type="number" id="doseOrdered" placeholder="Masukkan Dosis (misal: 125)" class="calc-input" min="0">
                        </div>

                        <div>
                            <label for="drugAvailable" class="block text-sm font-medium text-gray-700 mb-1">Ketersediaan Obat (mg) - Total Zat Aktif:</label>
                            <input type="number" id="drugAvailable" placeholder="Masukkan Ketersediaan (misal: 250)" class="calc-input" min="0">
                        </div>

                        <div>
                            <label for="volumeAvailable" class="block text-sm font-medium text-gray-700 mb-1">Volume Pelarut/Sediaan (mL):</label>
                            <input type="number" id="volumeAvailable" placeholder="Masukkan Volume (misal: 5)" class="calc-input" min="0">
                        </div>
                    </div>

                    <div class="bg-cyan-600 p-4 md:p-6 rounded-xl text-white shadow-xl mt-8">
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-semibold">Volume yang Dibutuhkan</span>
                            <span id="requiredVolume" class="text-2xl font-black">0.0 mL</span>
                        </div>
                        <p id="doseFormula" class="text-sm mt-2 font-medium">Formula: (Dosis Dikehendaki / Ketersediaan Obat) x Volume Pelarut</p>
                    </div>
                    
                    <button id="resetDosis" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl mt-8 transition duration-150 shadow-md hover:shadow-lg">
                        <span role="img" aria-label="emoji" class="mr-1">ðŸ”„</span> Reset Pilihan Dosis
                    </button>
                </div>
            </div>

            <div class="accordion-item border border-gray-300 rounded-xl overflow-hidden">
                <button class="accordion-header infus-header flex justify-between items-center w-full p-4 bg-gray-100 hover:bg-emerald-50 font-bold transition duration-200 text-left" data-target="calculatorInfus">
                    <span class="text-lg">ðŸ’§ Kalkulator Tetesan Infus</span>
                    <span class="accordion-icon transform transition duration-300 text-emerald-600">â–¼</span>
                </button>
                <div id="calculatorInfus" class="accordion-content p-4 bg-white hidden">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">ðŸ’§ Kalkulator Tetesan Infus</h2>
                    <p class="text-gray-500 mb-4">Hitung kecepatan tetesan (tetes/menit) untuk mengatur infus secara manual.</p>

                    <blockquote class="border-l-4 border-emerald-500 bg-emerald-50 p-3 mb-6 text-sm text-emerald-700">
                        **Tips:** Selalu konfirmasi faktor tetes set infus Anda (Makro: 15/20, Mikro: 60).
                    </blockquote>

                    <div class="space-y-4">
                        <div>
                            <label for="infusVolume" class="block text-sm font-medium text-gray-700 mb-1">Total Volume Infus (mL):</label>
                            <input type="number" id="infusVolume" placeholder="Misal: 500" class="calc-input" min="0">
                        </div>

                        <div>
                            <label for="infusTime" class="block text-sm font-medium text-gray-700 mb-1">Waktu Pemberian (Jam):</label>
                            <input type="number" id="infusTime" placeholder="Misal: 8 (Jam)" class="calc-input" min="0" step="0.5">
                        </div>

                        <div>
                            <label for="infusFactor" class="block text-sm font-medium text-gray-700 mb-1">Faktor Tetes (tetes/mL):</label>
                            <select id="infusFactor" class="calc-input">
                                <option value="20" selected>Makro (Dewasa - 20 tetes/mL)</option>
                                <option value="15">Makro (Set tertentu - 15 tetes/mL)</option>
                                <option value="60">Mikro (Anak/Buret - 60 tetes/mL)</option>
                            </select>
                        </div>
                    </div>

                    <div class="bg-emerald-600 p-4 md:p-6 rounded-xl text-white shadow-xl mt-8">
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-semibold">Kecepatan Tetesan (tetes/menit)</span>
                            <span id="dripRate" class="text-2xl font-black">0 tetes/menit</span>
                        </div>
                        <p id="infusFormula" class="text-sm mt-2 font-medium">Formula: (Volume x Faktor Tetes) / (Waktu (Jam) x 60)</p>
                    </div>
                    
                    <button id="resetInfus" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl mt-8 transition duration-150 shadow-md hover:shadow-lg">
                        <span role="img" aria-label="emoji" class="mr-1">ðŸ”„</span> Reset Pilihan Infus
                    </button>
                </div>
            </div>

            <div class="accordion-item border border-gray-300 rounded-xl overflow-hidden">
                <button class="accordion-header vaso-header flex justify-between items-center w-full p-4 bg-gray-100 hover:bg-red-50 font-bold transition duration-200 text-left" data-target="calculatorVasoDose">
                    <span class="text-lg">ðŸ©¸ Kalkulator Dosis Vasopressor/Syringe Pump</span>
                    <span class="accordion-icon transform transition duration-300 text-red-600">â–¼</span>
                </button>
                <div id="calculatorVasoDose" class="accordion-content p-4 bg-white hidden">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">ðŸ©¸ Kalkulator Dosis Vasopressor/Syringe Pump</h2>
                    <p class="text-gray-500 mb-4">Hitung Kecepatan Pompa (mL/Jam) berdasarkan Dosis (mcg/kgBB/menit).</p>

                    <blockquote class="border-l-4 border-red-500 bg-red-50 p-3 mb-6 text-sm text-red-700">
                        **Contoh Umum (Norepinephrine/Vascon):** 4 mg dalam 50 mL Larutan (D5/Nacl). Konsentrasi Obat: 4 mg. Volume Total: 50 mL.
                    </blockquote>

                    <div class="space-y-4">
                        <div>
                            <label for="vasoDose" class="block text-sm font-medium text-gray-700 mb-1">Dosis yang Dikehendaki (mcg/kgBB/menit):</label>
                            <input type="number" id="vasoDose" placeholder="Misal: 0.1 (mcg/kgBB/menit)" class="calc-input" min="0" step="0.01">
                        </div>

                        <div>
                            <label for="vasoWeight" class="block text-sm font-medium text-gray-700 mb-1">Berat Badan Pasien (kg):</label>
                            <input type="number" id="vasoWeight" placeholder="Misal: 70 (kg)" class="calc-input" min="1">
                        </div>
                        
                        <div>
                            <label for="vasoDrugMass" class="block text-sm font-medium text-gray-700 mb-1">Total Massa Obat (mg):</label>
                            <input type="number" id="vasoDrugMass" placeholder="Misal: 4 (mg)" class="calc-input" min="0.1">
                        </div>
                        
                        <div>
                            <label for="vasoTotalVolume" class="block text-sm font-medium text-gray-700 mb-1">Total Volume Pelarut (mL):</label>
                            <input type="number" id="vasoTotalVolume" placeholder="Misal: 50 (mL)" class="calc-input" min="1">
                        </div>
                    </div>

                    <div class="bg-red-600 p-4 md:p-6 rounded-xl text-white shadow-xl mt-8">
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-semibold">Kecepatan Syringe Pump (mL/Jam)</span>
                            <span id="vasoRate" class="text-2xl font-black">0.0 mL/Jam</span>
                        </div>
                        <p id="vasoFormula" class="text-sm mt-2 font-medium">Formula: (Dosis x BB x 60 Menit) / Konsentrasi Obat (mcg/mL)</p>
                    </div>
                    
                    <button id="resetVasoDose" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl mt-8 transition duration-150 shadow-md hover:shadow-lg">
                        <span role="img" aria-label="emoji" class="mr-1">ðŸ”„</span> Reset Pilihan Vasopressor
                    </button>
                </div>
            </div>

            <div class="accordion-item border border-gray-300 rounded-xl overflow-hidden">
                <button class="accordion-header nica-header flex justify-between items-center w-full p-4 bg-gray-100 hover:bg-indigo-50 font-bold transition duration-200 text-left" data-target="calculatorNicaDose">
                    <span class="text-lg">ðŸ’™ Kalkulator Dosis Nicardipine/Syringe Pump</span>
                    <span class="accordion-icon transform transition duration-300 text-indigo-600">â–¼</span>
                </button>
                <div id="calculatorNicaDose" class="accordion-content p-4 bg-white hidden">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">ðŸ’™ Kalkulator Dosis Nicardipine/Syringe Pump</h2>
                    <p class="text-gray-500 mb-4">Hitung Kecepatan Pompa (mL/Jam) berdasarkan Dosis (mcg/kgBB/menit).</p>

                    <blockquote class="border-l-4 border-indigo-500 bg-indigo-50 p-3 mb-6 text-sm text-indigo-700">
                        **Contoh Umum (Nicardipine):** 10 mg dalam 100 mL Larutan (NaCl/D5). Konsentrasi Obat: 10 mg. Volume Total: 100 mL.
                    </blockquote>

                    <div class="space-y-4">
                        <div>
                            <label for="nicaDose" class="block text-sm font-medium text-gray-700 mb-1">Dosis yang Dikehendaki (mcg/kgBB/menit):</label>
                            <input type="number" id="nicaDose" placeholder="Misal: 0.5 (mcg/kgBB/menit)" class="calc-input" min="0" step="0.01">
                        </div>

                        <div>
                            <label for="nicaWeight" class="block text-sm font-medium text-gray-700 mb-1">Berat Badan Pasien (kg):</label>
                            <input type="number" id="nicaWeight" placeholder="Misal: 70 (kg)" class="calc-input" min="1">
                        </div>
                        
                        <div>
                            <label for="nicaDrugMass" class="block text-sm font-medium text-gray-700 mb-1">Total Massa Obat (mg):</label>
                            <input type="number" id="nicaDrugMass" placeholder="Misal: 10 (mg)" class="calc-input" min="0.1">
                        </div>
                        
                        <div>
                            <label for="nicaTotalVolume" class="block text-sm font-medium text-gray-700 mb-1">Total Volume Pelarut (mL):</label>
                            <input type="number" id="nicaTotalVolume" placeholder="Misal: 100 (mL)" class="calc-input" min="1">
                        </div>
                    </div>

                    <div class="bg-indigo-600 p-4 md:p-6 rounded-xl text-white shadow-xl mt-8">
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-semibold">Kecepatan Syringe Pump (mL/Jam)</span>
                            <span id="nicaRate" class="text-2xl font-black">0.0 mL/Jam</span>
                        </div>
                        <p id="nicaFormula" class="text-sm mt-2 font-medium">Formula: (Dosis x BB x 60 Menit) / Konsentrasi Obat (mcg/mL)</p>
                    </div>
                    
                    <button id="resetNicaDose" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl mt-8 transition duration-150 shadow-md hover:shadow-lg">
                        <span role="img" aria-label="emoji" class="mr-1">ðŸ”„</span> Reset Pilihan Nicardipine
                    </button>
                </div>
            </div>

        </div>
        <p class="text-xs text-gray-400 mt-6 text-center leading-relaxed" id="footerNote">
            **Sumber Teori:** **TBSA** (Rule of Nines / Lund-Browder), **GCS** (Skala Glasgow Coma Scale Standar), **Dosis Obat** (Formula D/H x Q), **Infus** (Formula Tetesan Infus Standar: Volume x Faktor Tetes / Waktu), **Vasopressor/Nicardipine** (Perhitungan Dosis Berbasis Berat Badan & Konsentrasi mcg/mL).
        </p>

    </div>

    <script>
        // --- DATA DAN STATUS GLOBAL ---
        let currentGCS = { E: 1, V: 1, M: 1 };
        
        const percentageCycles = [
            { factor: 0, text: '0%', cssClass: '' },
            { factor: 0.5, text: '50%', cssClass: 'selected' },
            { factor: 1, text: '100%', cssClass: 'selected' }
        ];
        let currentMode = 'adult'; 

        // --- FUNGSI MULTITOOL (ACCORDION TOGGLE) ---

        function toggleAccordion(event) {
            const header = event.currentTarget;
            const targetId = header.dataset.target;
            const contentToToggle = document.getElementById(targetId);
            const icon = header.querySelector('.accordion-icon');
            
            // Cek apakah konten saat ini sedang terbuka
            const isCurrentlyOpen = !contentToToggle.classList.contains('hidden');

            // 1. Tutup semua konten dan reset ikon/header
            document.querySelectorAll('.accordion-content').forEach(content => content.classList.add('hidden'));
            document.querySelectorAll('.accordion-icon').forEach(i => i.classList.remove('rotate-180'));
            document.querySelectorAll('.accordion-header').forEach(h => h.classList.remove('active-header', 'tbsa-header', 'gcs-header', 'dosis-header', 'infus-header', 'vaso-header', 'nica-header'));
            document.querySelectorAll('.accordion-header').forEach(h => {
                // Hapus semua kelas header aktif unik sebelum menambahkan yang baru
                h.classList.remove('tbsa-header', 'gcs-header', 'dosis-header', 'infus-header', 'vaso-header', 'nica-header');
                // Tambahkan kembali kelas identifikasi header
                if (h.dataset.target === 'calculatorTBSA') h.classList.add('tbsa-header');
                if (h.dataset.target === 'calculatorGCS') h.classList.add('gcs-header');
                if (h.dataset.target === 'calculatorDosis') h.classList.add('dosis-header');
                if (h.dataset.target === 'calculatorInfus') h.classList.add('infus-header');
                if (h.dataset.target === 'calculatorVasoDose') h.classList.add('vaso-header');
                if (h.dataset.target === 'calculatorNicaDose') h.classList.add('nica-header');
            });


            if (!isCurrentlyOpen) {
                // 2. Buka konten yang diklik dan putar ikon
                contentToToggle.classList.remove('hidden');
                icon.classList.add('rotate-180');
                
                // Tambahkan kelas aktif unik berdasarkan targetId
                if (targetId === 'calculatorTBSA') header.classList.add('tbsa-header', 'active-header');
                else if (targetId === 'calculatorGCS') header.classList.add('gcs-header', 'active-header');
                else if (targetId === 'calculatorDosis') header.classList.add('dosis-header', 'active-header');
                else if (targetId === 'calculatorInfus') header.classList.add('infus-header', 'active-header');
                else if (targetId === 'calculatorVasoDose') header.classList.add('vaso-header', 'active-header');
                else if (targetId === 'calculatorNicaDose') header.classList.add('nica-header', 'active-header');
            }
        }


        // --- FUNGSI KALKULATOR INFUS ---
        function calculateInfus() {
            const volume = parseFloat(document.getElementById('infusVolume').value);
            const timeHours = parseFloat(document.getElementById('infusTime').value);
            const factor = parseFloat(document.getElementById('infusFactor').value);
            const dripRateDisplay = document.getElementById('dripRate');

            if (isNaN(volume) || isNaN(timeHours) || isNaN(factor) || 
                volume <= 0 || timeHours <= 0 || factor <= 0) {
                dripRateDisplay.textContent = '0 tetes/menit';
                return;
            }

            const timeMinutes = timeHours * 60;
            const dripRate = (volume * factor) / timeMinutes;
            
            dripRateDisplay.textContent = `${Math.round(dripRate)} tetes/menit`;
        }

        function resetInfus() {
            document.getElementById('infusVolume').value = '';
            document.getElementById('infusTime').value = '';
            document.getElementById('infusFactor').value = '20'; 
            calculateInfus();
            console.log("Pilihan Tetesan Infus telah direset.");
        }


        // --- FUNGSI DOSIS OBAT ---
        function calculateDosis() {
            const doseOrdered = parseFloat(document.getElementById('doseOrdered').value);
            const drugAvailable = parseFloat(document.getElementById('drugAvailable').value);
            const volumeAvailable = parseFloat(document.getElementById('volumeAvailable').value);
            const requiredVolumeDisplay = document.getElementById('requiredVolume');

            if (isNaN(doseOrdered) || isNaN(drugAvailable) || isNaN(volumeAvailable) || 
                doseOrdered <= 0 || drugAvailable <= 0 || volumeAvailable <= 0) {
                requiredVolumeDisplay.textContent = '0.0 mL';
                return;
            }

            const requiredVolume = (doseOrdered / drugAvailable) * volumeAvailable;
            requiredVolumeDisplay.textContent = `${requiredVolume.toFixed(2)} mL`;
        }

        function resetDosis() {
            document.getElementById('doseOrdered').value = '';
            document.getElementById('drugAvailable').value = '';
            document.getElementById('volumeAvailable').value = '';
            calculateDosis();
            console.log("Pilihan Dosis telah direset.");
        }


        // --- FUNGSI GCS ---
        function calculateGCS() {
            const totalScore = currentGCS.E + currentGCS.V + currentGCS.M;
            document.getElementById('totalGCS').textContent = totalScore;
            
            let interpretation = '';
            if (totalScore >= 13) {
                interpretation = `Cedera Kepala Ringan (GCS ${totalScore}).`;
            } else if (totalScore >= 9 && totalScore <= 12) {
                interpretation = `Cedera Kepala Sedang (GCS ${totalScore}).`;
            } else { 
                interpretation = `Cedera Kepala Berat (GCS ${totalScore}). Intubasi & Resusitasi dipertimbangkan.`;
            }
            document.getElementById('gcsInterpretation').textContent = interpretation;
        }

        function handleGCSClick(event) {
            const card = event.currentTarget;
            const category = card.dataset.category;
            const score = parseInt(card.dataset.score);
            const label = card.dataset.label;

            currentGCS[category] = score;

            document.querySelectorAll(`#gcs${category} .gcs-score-card`).forEach(c => c.classList.remove('active-score'));
            card.classList.add('active-score');
            
            document.getElementById(`gcs${category}Label`).textContent = `Respon saat ini: ${label} (${score})`;

            calculateGCS();
        }
        
        function resetGCS() {
            currentGCS = { E: 1, V: 1, M: 1 };
            
            document.querySelectorAll('.gcs-score-card').forEach(card => {
                card.classList.remove('active-score');
                if (parseInt(card.dataset.score) === 1) {
                    card.classList.add('active-score');
                }
            });
            
            document.getElementById('gcsELabel').textContent = 'Respon saat ini: Tidak Ada (1)';
            document.getElementById('gcsVLabel').textContent = 'Respon saat ini: Tidak Ada (1)';
            document.getElementById('gcsMLabel').textContent = 'Respon saat ini: Tidak Ada (1)';

            calculateGCS();
        }

        // --- FUNGSI TBSA ---
        function formatTBSA(tbsa) {
            const roundedTBSA = Math.round(tbsa * 10) / 10;
            if (roundedTBSA % 1 === 0) {
                return `${roundedTBSA.toFixed(0)}%`;
            } else {
                return `${roundedTBSA.toFixed(1)}%`;
            }
        }
        
        function calculateTBSA() {
            const partCards = document.querySelectorAll('#calculatorTBSA .tbsa-part-card');
            const tbsaBox = document.getElementById('tbsaBox');
            let totalTBSA = 0;
            
            partCards.forEach(card => {
                const baseValue = parseFloat(card.dataset.value); 
                const currentFactor = parseFloat(card.dataset.currentPercent);
                totalTBSA += baseValue * currentFactor;
            });

            document.getElementById('totalTBSA').textContent = formatTBSA(totalTBSA);
            
            // Logika Warna Kotak Hasil TBSA: Orange-500 (default) vs Red-700 (critical)
            if (totalTBSA >= 20) {
                tbsaBox.classList.add('tbsa-critical'); // Deep Red
                tbsaBox.classList.remove('bg-orange-500'); 
            } else {
                tbsaBox.classList.remove('tbsa-critical');
                tbsaBox.classList.add('bg-orange-500');
            }
        }

        function handlePartClick(event) {
            const card = event.currentTarget;
            let currentFactor = parseFloat(card.dataset.currentPercent);
            
            let currentIndex = percentageCycles.findIndex(p => p.factor === currentFactor);
            let nextIndex = (currentIndex + 1) % percentageCycles.length;
            const nextCycle = percentageCycles[nextIndex];

            card.dataset.currentPercent = nextCycle.factor;
            
            const percentageDisplay = card.querySelector('.part-percentage');
            percentageDisplay.textContent = nextCycle.text;

            if (nextCycle.cssClass) {
                card.classList.add(nextCycle.cssClass);
            } else {
                card.classList.remove('selected');
            }
            
            calculateTBSA();
        }

        function changeMode(mode) {
            if (currentMode === mode) return;
            
            currentMode = mode;
            const partCards = document.querySelectorAll('#calculatorTBSA .part-card');
            const isChildMode = mode === 'child';

            const adultBtn = document.getElementById('modeAdult');
            const childBtn = document.getElementById('modeChild');
            const btnClassToChange = ['bg-orange-500', 'border-orange-500', 'bg-gray-100', 'text-gray-700', 'text-white', 'border-gray-300', 'hover:bg-orange-50', 'hover:border-orange-500'];
            
            // Function to swap classes for buttons
            function updateBtnClasses(btn, isActive) {
                if (isActive) {
                    btn.classList.add('bg-orange-500', 'border-orange-500', 'text-white');
                    btn.classList.remove('bg-gray-100', 'border-gray-300', 'text-gray-700', 'hover:bg-orange-50', 'hover:border-orange-500');
                } else {
                    btn.classList.add('bg-gray-100', 'border-gray-300', 'text-gray-700', 'hover:bg-orange-50', 'hover:border-orange-500');
                    btn.classList.remove('bg-orange-500', 'border-orange-500', 'text-white');
                }
            }

            updateBtnClasses(adultBtn, !isChildMode);
            updateBtnClasses(childBtn, isChildMode);

            partCards.forEach(card => {
                const newValue = isChildMode ? card.dataset.valueChild : card.dataset.valueAdult;
                card.dataset.value = newValue;
                
                const fullValueDisplay = card.querySelector('.part-full-value');
                fullValueDisplay.textContent = `Nilai Penuh: ${formatTBSA(parseFloat(newValue))}`;
            });
            
            if (isChildMode) {
                document.getElementById('methodNote').textContent = "Nilai didasarkan pada proporsi Lund-Browder yang disederhanakan (Anak usia 1 tahun).";
            } else {
                document.getElementById('methodNote').textContent = "Nilai didasarkan pada Rule of Nines untuk Dewasa (9%, 18%, 1%).";
            }

            resetTBSA(false);
        }

        function resetTBSA(showConsoleLog = true) {
            const partCards = document.querySelectorAll('#calculatorTBSA .part-card');
            
            partCards.forEach(card => {
                card.dataset.currentPercent = 0;
                card.classList.remove('selected');
                card.querySelector('.part-percentage').textContent = '0%';
            });
            
            calculateTBSA();
            
            if (showConsoleLog) {
                console.log("Pilihan TBSA telah direset.");
            }
        }

        // --- FUNGSI DOSIS VASOPRESSOR (VASCON) ---
        function calculateVasoDose() {
            const dose = parseFloat(document.getElementById('vasoDose').value); // mcg/kgBB/menit
            const weight = parseFloat(document.getElementById('vasoWeight').value); // kg
            const drugMass = parseFloat(document.getElementById('vasoDrugMass').value); // mg
            const totalVolume = parseFloat(document.getElementById('vasoTotalVolume').value); // mL
            const vasoRateDisplay = document.getElementById('vasoRate');

            if (isNaN(dose) || isNaN(weight) || isNaN(drugMass) || isNaN(totalVolume) || 
                dose <= 0 || weight <= 0 || drugMass <= 0 || totalVolume <= 0) {
                vasoRateDisplay.textContent = '0.0 mL/Jam';
                return;
            }

            // 1. Hitung Konsentrasi Obat dalam mcg/mL
            // Massa Obat (mg) * 1000 = Massa Obat (mcg)
            // Konsentrasi (mcg/mL) = (Massa Obat Total (mg) * 1000) / Volume Pelarut Total (mL)
            const concentration_mcg_per_mL = (drugMass * 1000) / totalVolume;

            // 2. Hitung Laju Infus (mL/Jam)
            // Formula: (Dosis (mcg/kgBB/menit) * BB (kg) * 60 menit/jam) / Konsentrasi (mcg/mL)
            const rate_mL_per_hour = (dose * weight * 60) / concentration_mcg_per_mL;
            
            vasoRateDisplay.textContent = `${rate_mL_per_hour.toFixed(2)} mL/Jam`;
        }

        function resetVasoDose() {
            document.getElementById('vasoDose').value = '';
            document.getElementById('vasoWeight').value = '';
            document.getElementById('vasoDrugMass').value = '';
            document.getElementById('vasoTotalVolume').value = '';
            calculateVasoDose();
            console.log("Pilihan Dosis Vasopressor telah direset.");
        }
        
        // --- FUNGSI DOSIS NICARDIPINE ---
        function calculateNicaDose() {
            const dose = parseFloat(document.getElementById('nicaDose').value); // mcg/kgBB/menit
            const weight = parseFloat(document.getElementById('nicaWeight').value); // kg
            const drugMass = parseFloat(document.getElementById('nicaDrugMass').value); // mg
            const totalVolume = parseFloat(document.getElementById('nicaTotalVolume').value); // mL
            const nicaRateDisplay = document.getElementById('nicaRate');

            if (isNaN(dose) || isNaN(weight) || isNaN(drugMass) || isNaN(totalVolume) || 
                dose <= 0 || weight <= 0 || drugMass <= 0 || totalVolume <= 0) {
                nicaRateDisplay.textContent = '0.0 mL/Jam';
                return;
            }

            // 1. Hitung Konsentrasi Obat dalam mcg/mL
            // Massa Obat (mg) * 1000 = Massa Obat (mcg)
            // Konsentrasi (mcg/mL) = (Massa Obat Total (mg) * 1000) / Volume Pelarut Total (mL)
            const concentration_mcg_per_mL = (drugMass * 1000) / totalVolume;

            // 2. Hitung Laju Infus (mL/Jam)
            // Formula: (Dosis (mcg/kgBB/menit) * BB (kg) * 60 menit/jam) / Konsentrasi (mcg/mL)
            const rate_mL_per_hour = (dose * weight * 60) / concentration_mcg_per_mL;
            
            nicaRateDisplay.textContent = `${rate_mL_per_hour.toFixed(2)} mL/Jam`;
        }

        function resetNicaDose() {
            document.getElementById('nicaDose').value = '';
            document.getElementById('nicaWeight').value = '';
            document.getElementById('nicaDrugMass').value = '';
            document.getElementById('nicaTotalVolume').value = '';
            calculateNicaDose();
            console.log("Pilihan Dosis Nicardipine telah direset.");
        }


        // --- SETUP DAN EVENT LISTENERS ---
        window.onload = function() {
            // Setup Accordion Toggle
            document.querySelectorAll('.accordion-header').forEach(header => {
                header.addEventListener('click', toggleAccordion);
            });
            
            // Atur TBSA terbuka secara default (dan warna header aktif)
            const defaultHeader = document.querySelector('.accordion-header[data-target="calculatorTBSA"]');
            const defaultContent = document.getElementById('calculatorTBSA');
            if (defaultContent && defaultHeader) {
                defaultContent.classList.remove('hidden'); 
                defaultHeader.classList.add('tbsa-header', 'active-header');
                defaultHeader.querySelector('.accordion-icon').classList.add('rotate-180');
            }


            // Setup TBSA
            document.querySelectorAll('#calculatorTBSA .part-card').forEach(card => {
                card.addEventListener('click', handlePartClick);
            });
            document.getElementById('resetTBSA').addEventListener('click', () => resetTBSA(true));
            document.getElementById('modeAdult').addEventListener('click', () => changeMode('adult'));
            document.getElementById('modeChild').addEventListener('click', () => changeMode('child'));
            changeMode('adult');

            // Setup GCS
            document.querySelectorAll('.gcs-score-card').forEach(card => {
                card.addEventListener('click', handleGCSClick);
            });
            document.getElementById('resetGCS').addEventListener('click', resetGCS);
            resetGCS();

            // Setup Dosis
            document.getElementById('doseOrdered').addEventListener('input', calculateDosis);
            document.getElementById('drugAvailable').addEventListener('input', calculateDosis);
            document.getElementById('volumeAvailable').addEventListener('input', calculateDosis);
            document.getElementById('resetDosis').addEventListener('click', resetDosis);
            calculateDosis();

            // Setup Infus
            document.getElementById('infusVolume').addEventListener('input', calculateInfus);
            document.getElementById('infusTime').addEventListener('input', calculateInfus);
            document.getElementById('infusFactor').addEventListener('change', calculateInfus);
            document.getElementById('resetInfus').addEventListener('click', resetInfus);
            calculateInfus();

            // Setup Vaso Dose
            document.getElementById('vasoDose').addEventListener('input', calculateVasoDose);
            document.getElementById('vasoWeight').addEventListener('input', calculateVasoDose);
            document.getElementById('vasoDrugMass').addEventListener('input', calculateVasoDose);
            document.getElementById('vasoTotalVolume').addEventListener('input', calculateVasoDose);
            document.getElementById('resetVasoDose').addEventListener('click', resetVasoDose);
            calculateVasoDose();
            
            // Setup Nica Dose
            document.getElementById('nicaDose').addEventListener('input', calculateNicaDose);
            document.getElementById('nicaWeight').addEventListener('input', calculateNicaDose);
            document.getElementById('nicaDrugMass').addEventListener('input', calculateNicaDose);
            document.getElementById('nicaTotalVolume').addEventListener('input', calculateNicaDose);
            document.getElementById('resetNicaDose').addEventListener('click', resetNicaDose);
            calculateNicaDose();
        };
    </script>
</body>
</html>
